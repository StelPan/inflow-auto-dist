import{s as B}from"./button.esm-48574c78.js";import{s as V}from"./card.esm-90d7995a.js";import{b as I,a as x,o as N,_ as R,m as a,x as S,p,f as _,c as n,h as t,B as f,j as h,g as b,t as C}from"./_plugin-vue_export-helper-4e0f1051.js";import{u as K}from"./vue-router-e112b3e0.js";import{F as M}from"./FormCalendar-db92c851.js";import{F as T}from"./FormInput-98bf5b06.js";import{F as A}from"./FormItem-904d0fd7.js";import{a as P,D as U,C as W}from"./principalDeals-5bcfc342.js";import{u as j}from"./Api-3d31057e.js";import{T as z,W as q}from"./Wrap-056f41a0.js";import"./ripple.esm-2bb5fa45.js";import"./Cookies-c25692b0.js";import"./dayjs.min-18f6db6c.js";import"./overlayeventbus.esm-47a43062.js";import"./portal.esm-58de97e7.js";import"./runtime-dom.esm-bundler-b3385430.js";import"./DateTime-6dd15e58.js";import"./inputnumber.esm-b284c98e.js";import"./index.es-55ebbfbf.js";import"./progressspinner.esm-2138ab26.js";import"./index-5ce0c5bc.js";import"./FormLayout-e63b5088.js";const G={components:{FormCalendar:M,FormInput:T,Card:V,TitleBox:z,Wrap:q,FormItem:A,Button:B},setup(){var u;const l=K(),{principalState:s}=j(),i=l.params.dealID,o=I(()=>l.params.dealID==="create"),r=x({}),c=x({});o.value?r.value={dkp_number:"",dkp_date:"",dkp_photos:[],photo:""}:((u=s.deal)==null?void 0:u.data.id)!==Number(i)?N(()=>m()):r.value={dkp_number:s.deal.data.dkp.dkp_number,dkp_date:s.deal.data.dkp.dkp_date,dkp_photos:s.deal.data.dkp.dkp_photos,photo:null};const m=async()=>{const e=await P(i);e&&(r.value={dkp_number:e.dkp.dkp_number,photo:null,dkp_date:e.dkp.dkp_date,dkp_photos:e.dkp.dkp_photos})};return{data:r,postDealDKP:U,handleError:async e=>{c.value=e},principalState:s,setFile:e=>{r.value.photo=e.target.files[0]},removeFile:e=>{W(i,{uuid:e}),m()},errors:c,getFileName:e=>{if(e)return e.split("/").reverse()[0]}}}},H="DealDKP_doc_1691548060501",J={doc:H},L={class:"grid"},O={class:"col-4"},Q=t("i",{class:"text-red-500"},"*",-1),X={class:"col-4"},Y=t("i",{class:"text-red-500"},"*",-1),Z={class:"col-4"},$=t("div",{class:"text-sm"},[f(" Соглашение"),t("i",{class:"text-red-500"},"*")],-1),oo={key:0,class:"relative"},eo=t("i",{class:"pi pi-plus"},null,-1),to=t("i",{class:"pi pi-file"},null,-1),so={class:"text-overflow-ellipsis"};function ao(l,s,i,o,r,c){const m=a("TitleBox"),k=a("FormInput"),F=a("FormCalendar"),v=a("Button"),D=a("FormItem"),u=a("Card"),e=a("Wrap");return _(),S(e,{class:"p-4",data:o.data,apiMethod:o.postDealDKP,onUpdateError:o.handleError},{default:p(()=>[n(m,{nameSection:"Договор купли - продажи ТС"}),n(u,{class:"mb-5 mt-5"},{content:p(()=>{var E;return[t("div",L,[t("div",O,[n(k,{type:"text",name:"dkp_number",modelValue:o.data.dkp_number,"onUpdate:modelValue":s[0]||(s[0]=d=>o.data.dkp_number=d),label:"Номер ДКП",showErrors:o.errors.isShow,errorResponse:o.errors.response},{default:p(()=>[f("Номер ДКП "),Q]),_:1},8,["modelValue","showErrors","errorResponse"])]),t("div",X,[n(F,{type:"text",name:"dkp_date",modelValue:o.data.dkp_date,"onUpdate:modelValue":s[1]||(s[1]=d=>o.data.dkp_date=d),label:"Дата",showErrors:o.errors.isShow,errorResponse:o.errors.response},{default:p(()=>[f("Дата "),Y]),_:1},8,["modelValue","showErrors","errorResponse"])]),t("div",Z,[n(D,{name:"photo",modelValue:(E=o.data.photo)==null?void 0:E.name,showErrors:o.errors.isShow,errorResponse:o.errors.response},{default:p(({isError:d})=>{var g,w;return[t("div",{class:h([d&&"error",""])},[$,(g=o.data.dkp_photos)!=null&&g.length?(_(),b("p",{key:1,class:h([[l.$style.doc],"flex gap-2 align-items-center"])},[to,t("span",so,C(o.getFileName(o.data.dkp_photos[0].original_url)),1),n(v,{icon:"pi pi-trash",class:"p-button-danger flex-shrink-0 ml-auto",onClick:s[3]||(s[3]=()=>o.removeFile(o.data.dkp_photos[0].uuid))})],2)):(_(),b("div",oo,[t("label",{class:h([[l.$style.doc,!o.data.photo&&"justify-content-center"],"flex gap-2 align-items-center"])},[t("input",{type:"file",name:"photo",id:"",onChange:s[2]||(s[2]=(...y)=>o.setFile&&o.setFile(...y))},null,32),eo,t("span",null,C((w=o.data.photo)==null?void 0:w.name),1)],2)]))],2)]}),_:1},8,["modelValue","showErrors","errorResponse"])])])]}),_:1})]),_:1},8,["data","apiMethod","onUpdateError"])}const ro={$style:J},Vo=R(G,[["render",ao],["__cssModules",ro],["__file","/var/www/inflow-auto-front-main/src/views/deals/negotiation/DealDKP.vue"]]);export{Vo as default};
