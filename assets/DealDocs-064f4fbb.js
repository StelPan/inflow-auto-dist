import{b as y,a as f,o as x,_ as I,m as n,x as h,p as w,f as D,c as F,g as B,u as E,F as q}from"./_plugin-vue_export-helper-4e0f1051.js";import{u as P}from"./vue-router-e112b3e0.js";import{D as b,F as k}from"./DocInfo-cf2bf3f4.js";import{a as C,s as S,t as T}from"./principalDeals-5bcfc342.js";import{u as W}from"./Api-3d31057e.js";import{T as g,W as G}from"./Wrap-35d78bea.js";import"./Cookies-c25692b0.js";import"./index.es-55ebbfbf.js";import"./runtime-dom.esm-bundler-b3385430.js";import"./dayjs.min-18f6db6c.js";import"./DateTime-6dd15e58.js";import"./button.esm-48574c78.js";import"./ripple.esm-2bb5fa45.js";import"./progressspinner.esm-2138ab26.js";import"./index-72d7336d.js";import"./FormLayout-5c19cd5a.js";const M={components:{DocInfo:b,FileGroup:k,TitleBox:g,Wrap:G},setup(){var o;const i=P(),{principalState:a}=W(),r=i.params.dealID,t=y(()=>i.params.dealID==="create"),s=f([]),p=f({}),c=f({}),m=[{type:"pts",title:"ПТС",required:2,photos:[]},{type:"sts",title:"СТС",required:2,photos:[]},{type:"passport",title:"Паспорт",required:2,photos:[]},{type:"proxy",title:"Доверенность",required:1,photos:[]}];t.value||(((o=a.deal)==null?void 0:o.data.id)!==Number(r)?x(()=>l()):s.value=a.deal.data.documents);const l=async()=>{const e=await C(r);e!=null&&e.car&&(s.value=e.documents)};return{docs:s,postDealDocs:S,handleError:async e=>{c.value=e},principalState:a,setPreloadFile:(e,v)=>{p.value[v]=e},preloadFile:p,removeFile:e=>{T(r,{uuid:e}),l()},defaultData:m}}};function N(i,a,r,t,s,p){const c=n("TitleBox"),m=n("DocInfo"),l=n("FileGroup"),_=n("Wrap");return D(),h(_,{class:"p-4",data:t.preloadFile,apiMethod:t.postDealDocs,onUpdateError:t.handleError},{default:w(()=>{var u,d;return[F(c,{nameSection:"Документы"}),F(m,{class:"mt-4 mb-5"}),(D(!0),B(q,null,E(((d=(u=t.principalState.deal)==null?void 0:u.data)==null?void 0:d.documents)||t.defaultData,o=>(D(),h(l,{key:o.type,title:`${o.title} ${o.photos.length} из ${o.required}`,photos:o.photos,class:"mb-4",setPreloadFile:e=>t.setPreloadFile(e,o.type),returnIDForDeletion:t.removeFile,multiple:""},null,8,["title","photos","setPreloadFile","returnIDForDeletion"]))),128))]}),_:1},8,["data","apiMethod","onUpdateError"])}const ee=I(M,[["render",N],["__file","/var/www/inflow-auto-front-main/src/views/deals/draft/DealDocs.vue"]]);export{ee as default};
